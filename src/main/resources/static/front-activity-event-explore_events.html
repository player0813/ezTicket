<!DOCTYPE html>
<html lang="en" class="h-100">
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, shrink-to-fit=9" />
    <meta name="description" content="Gambolthemes" />
    <meta name="author" content="Gambolthemes" />
    <title>ezTicket - 探索節目</title>

    <!-- Favicon Icon -->
    <link rel="icon" type="image/png" href="images/fav.png" />

    <!-- Stylesheets -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,300;0,400;0,500;0,700;0,900;1,100;1,300;1,400;1,500;1,700;1,900&display=swap"
      rel="stylesheet"
    />
    <link href="vendor/unicons-2.0.1/css/unicons.css" rel="stylesheet" />
    <link href="css/style.css" rel="stylesheet" />
    <link href="css/responsive.css" rel="stylesheet" />
    <link href="css/night-mode.css" rel="stylesheet" />

    <!-- Vendor Stylesheets -->
    <link href="vendor/fontawesome-free/css/all.min.css" rel="stylesheet" />
    <link href="vendor/OwlCarousel/assets/owl.carousel.css" rel="stylesheet" />
    <link
      href="vendor/OwlCarousel/assets/owl.theme.default.min.css"
      rel="stylesheet"
    />
    <link href="vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet" />
    <link
      href="vendor/bootstrap-select/dist/css/bootstrap-select.min.css"
      rel="stylesheet"
    />
  

  </head>

  <body class="d-flex flex-column h-100">
   <!-- Header Start-->
   <header class="header">
    <div class="header-inner">
        <nav
            class="navbar navbar-expand-lg bg-barren barren-head navbar fixed-top justify-content-sm-start pt-0 pb-0">
            <div class="container">
                <button class="navbar-toggler" type="button" data-bs-toggle="offcanvas"
                    data-bs-target="#offcanvasNavbar" aria-controls="offcanvasNavbar">
                    <span class="navbar-toggler-icon">
                        <i class="fa-solid fa-bars"></i>
                    </span>
                </button>
                <a class="navbar-brand order-1 order-lg-0 ml-lg-0 ml-2 me-auto" href="index.html">
                    <div class="res-main-logo">
                        <img src="images/ezTicket-icon.svg" alt="">
                    </div>
                    <div class="main-logo" id="logo">
                        <img src="images/ezTicket.svg" alt="">
                        <img class="logo-inverse" src="images/dark-logo.svg" alt="">
                    </div>
                </a>
                <div class="offcanvas offcanvas-start" tabindex="-1" id="offcanvasNavbar"
                    aria-labelledby="offcanvasNavbarLabel">
                    <div class="offcanvas-header">
                        <div class="offcanvas-logo" id="offcanvasNavbarLabel">
                            <img src="images/ezTicket-icon.svg" alt="">
                        </div>
                        <button type="button" class="close-btn" data-bs-dismiss="offcanvas" aria-label="Close">
                            <i class="fa-solid fa-xmark"></i>
                        </button>
                    </div>
                    <div class="offcanvas-body">
                        <ul class="navbar-nav justify-content-end flex-grow-1 pe_5">
                            <li class="nav-item">
                                <a class="nav-link active" aria-current="page"
                                    href="front-activity-event-explore_events.html"
                                    style="color:black !important">探索節目</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link active" aria-current="page"
                                    href="front-product-explore_products.html"
                                    style="color:black !important">探索商品</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link active" aria-current="page" href="#"
                                    style="color:black !important">常見問題</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link active" aria-current="page" href="#"
                                    style="color:black !important">最新消息</a>
                            </li>

                        </ul>
                    </div>
                </div>
                <div class="right-header order-2">
                    <ul class="align-self-stretch">
                        <li>
                            <a href="front-activity-event-explore_events.html" class="create-btn btn-hover">
                                <i class="fa-solid fa-calendar-days"></i>
                                <span>節目訂票</span>
                            </a>
                            <a href="front-product-explore_products.html" class="create-btn btn-hover">
                                <i class="fa-sharp fa-solid fa-bag-shopping"></i>
                                <span>聯名商品</span>
                            </a>
                        </li>
                        <li>

                        </li>
                        <li class="dropdown account-dropdown">
                            <a href="#" class="account-link" role="button" id="accountClick"
                                data-bs-auto-close="outside" data-bs-toggle="dropdown" aria-expanded="false">
                                <img class="D-mimg" src="images/profile-imgs/img-13.jpg" alt="">
                                <i class="fas fa-caret-down arrow-icon"></i>
                            </a>
                            <ul class="dropdown-menu dropdown-menu-account dropdown-menu-end"
                                aria-labelledby="accountClick">
                                <li>
                                    <div class="dropdown-account-header">
                                        <div class="account-holder-avatar">
                                            <img class="D-mimg" src="images/profile-imgs/img-13.jpg" alt="">
                                        </div>
                                        <h5 class="D-mname">會員名稱</h5>
                                        <p class="D-memail">johndoe@example.com</p>
                                    </div>
                                </li>
                                <li class="profile-link">
                                    <a class="dropdown-item pe-5" href="front-users-member-profile.html">會員資訊</a>
                                    <a class="dropdown-item pe-5" href="front-users-mem-sign-in.html">登入</a>
                                    <a class="dropdown-item pe-5" href="front-users-sign-up.html">註冊</a>
                                    <a class="dropdown-item pe-5" href="front-users-forgot-pwd.html">忘記密碼</a>

                                </li>
                            </ul>
                        </li>
                        <li class="dropdown account-dropdown">
                            <a href="front-product-shopping_cart.html" class="account-link">
                                <div id="cart">
                                    <img src="images/profile-imgs/cart2.jpg">
                                    <span class="badge" style="color:#102743 ;">0</span>
                                </div>
                            </a>
                        </li>
                    </ul>
                </div>
            </div>
        </nav>
        <div class="overlay"></div>
    </div>
</header>
<!-- Header End-->
    <!-- Body Start-->
    <div class="wrapper">
      <div class="hero-banner">
        <div class="container">
          <div class="row justify-content-center">
            <div class="col-xl-8 col-lg-8 col-md-10">
              <div class="hero-banner-content">
                <h2>立即開始搜尋美好的節目</h2>
                <div class="search-form main-form">
                  <div class="row g-3" style="justify-content: center">
                    <div class="col-lg-5 col-md-12">
                      <div class="form-group">
                        <input
                          type="text"
                          name="search"
                          id="search"
                          placeholder="搜尋節目"
                          class="form-control"
                        />
                      </div>
                    </div>
              
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="explore-events p-80">
        <div class="container">
          <div class="row">
            <div class="col-xl-12 col-lg-12 col-md-12">
              <div class="event-filter-items">
                <div class="featured-controls">
                  <div class="controls" id="aclassList" style="display: flex; justify-content: space-evenly;">
                    <button type="button" class="control" id="allEventbtn" >
                      全部
                    </button>                    
                  </div>
                  <div class="row" data-ref="event-filter-content" id="listTab">
                    
                        </div>
                      </div>
                    </div>
                  </div>
                  <div class="browse-btn" style="margin-top: 75px">
                    <a href="#" class="main-btn btn-hover">更多節目</a>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <!-- Body End-->
    <!-- Footer Start-->
    <footer class="footer mt-auto">
      <!-- <div class="footer-top">
        <div class="container">
          <div class="row">
            <div class="col-lg-3 col-md-6">
              <div class="footer-content">
                <h4>Company</h4>
                <ul class="footer-link-list">
                  <li>
                    <a href="about_us.html" class="footer-link">About Us</a>
                  </li>
                  <li>
                    <a href="help_center.html" class="footer-link"
                      >Help Center</a
                    >
                  </li>
                  <li><a href="faq.html" class="footer-link">FAQ</a></li>
                  <li>
                    <a href="contact_us.html" class="footer-link">Contact Us</a>
                  </li>
                </ul>
              </div>
            </div>
            <div class="col-lg-3 col-md-6">
              <div class="footer-content">
                <h4>Useful Links</h4>
                <ul class="footer-link-list">
                  <li>
                    <a href="create.html" class="footer-link">Create Event</a>
                  </li>
                  <li>
                    <a href="sell_tickets_online.html" class="footer-link"
                      >Sell Tickets Online</a
                    >
                  </li>
                  <li>
                    <a href="privacy_policy.html" class="footer-link"
                      >Privacy Policy</a
                    >
                  </li>
                  <li>
                    <a href="term_and_conditions.html" class="footer-link"
                      >Terms & Conditions</a
                    >
                  </li>
                </ul>
              </div>
            </div>
            <div class="col-lg-3 col-md-6">
              <div class="footer-content">
                <h4>Resources</h4>
                <ul class="footer-link-list">
                  <li>
                    <a href="pricing.html" class="footer-link">Pricing</a>
                  </li>
                  <li><a href="our_blog.html" class="footer-link">Blog</a></li>
                  <li>
                    <a href="refer_a_friend.html" class="footer-link"
                      >Refer a Friend</a
                    >
                  </li>
                </ul>
              </div>
            </div>
            <div class="col-lg-3 col-md-6">
              <div class="footer-content">
                <h4>Follow Us</h4>
                <ul class="social-links">
                  <li>
                    <a href="#" class="social-link"
                      ><i class="fab fa-facebook-square"></i
                    ></a>
                  </li>
                  <li>
                    <a href="#" class="social-link"
                      ><i class="fab fa-instagram"></i
                    ></a>
                  </li>
                  <li>
                    <a href="#" class="social-link"
                      ><i class="fab fa-twitter"></i
                    ></a>
                  </li>
                  <li>
                    <a href="#" class="social-link"
                      ><i class="fab fa-linkedin-in"></i
                    ></a>
                  </li>
                  <li>
                    <a href="#" class="social-link"
                      ><i class="fab fa-youtube"></i
                    ></a>
                  </li>
                </ul>
              </div>
              <div class="footer-content">
                <h4>Download Mobile App</h4>
                <div class="download-app-link">
                  <a href="#" class="download-btn"
                    ><img src="images/app-store.png" alt=""
                  /></a>
                  <a href="#" class="download-btn"
                    ><img src="images/google-play.png" alt=""
                  /></a>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div> -->
      <div class="footer-bottom">
        <div class="container">
          <div class="row">
            <div class="col-12">
              <div class="footer-copyright-text">
                <p class="mb-0">© 2023, <strong>ezTicket</strong>. All rights reserved. Powered by CGA106Group2</p>
              </div>
            </div>
          </div>
        </div>
      </div>
    </footer>
    <!-- Footer End-->

    <script src="js/jquery-3.6.0.min.js"></script>
    <script src="vendor/bootstrap/js/bootstrap.bundle.min.js"></script>
    <script src="vendor/OwlCarousel/owl.carousel.js"></script>
    <script src="vendor/bootstrap-select/dist/js/bootstrap-select.min.js"></script>
    <script src="vendor/mixitup/dist/mixitup.min.js"></script>
    <script src="js/custom.js"></script>
    <script src="js/night-mode.js"></script>
      <!-- kai 會員登入狀態驗證(不導向版) -->
      <script src="js/memberLoginCheck.js"></script>
    <script>
      var containerEl = document.querySelector(
        '[data-ref~="event-filter-content"]'
      );

      var mixer = mixitup(containerEl, {
        selectors: {
          target: '[data-ref~="mixitup-target"]',
        },
      });
    </script>
    <script>
      let now = new Date();
      const options = {
          year: 'numeric',    // 年: 使用4位數
          month: '2-digit',   // 月: 使用2數位
          day: '2-digit',     // 日: 使用2數位
          hour12: false,      // 12小時制: 不使用
          hour: '2-digit',    // 時: 使用2數位
          minute: '2-digit'  // 分: 使用2數位 
        };
        let nowDate=new Intl.DateTimeFormat('zh-TW', options).format(now);
        console.log(nowDate)
      function dateDiffer(date1, date2) {
  const diffInMs = Math.abs(date2 - date1);
  const diffInDays = Math.floor(diffInMs / (1000 * 60 * 60 * 24));
  const diffInHours = Math.floor(diffInMs / (1000 * 60 * 60) % 24);
  return `倒數 ${diffInDays}天又${diffInHours}小時`;
}


      const listTab = document.querySelector("#listTab");
      fetch("/Activity/findAll")
        .then((Response) => Response.json())
        .then((data) => {
          data.reverse();
          let str = "";
          let sTime="";
          let countDays="";
          for (i of data) {
            
            console.log(i.session[0]);
            if(i.astatus==1){
              if( i.wetherSeat ==0){
                sTime="全站";
                countDays="售完為止"
              }else{
                sTime= i.session[0].sessionsTime;
                const date = new Date(i.session[0].sessionsTime);
                console.log(dateDiffer(nowDate, date))
               countDays = dateDiffer(now, date);
                
              }

            str += `<div
                      class="col-xl-3 col-lg-4 col-md-6 col-sm-12 mix arts concert workshops volunteer sports health_Wellness"
                      data-ref="mixitup-target"
                    >
                      <div class="main-card mt-4">
                        <div class="event-thumbnail">
                          <a
                            href="front-activity-event-detail.html?activityNo=${i.activityNo}"
                            class="thumbnail-img"
                          >
                            <img src="data:image/jpeg;base64,${i.aimgt[0].aimg }" alt="" />
                          </a>
                          <span class="bookmark-icon" title="Bookmark"></span>
                        </div>
                        <div class="event-content">
                          <a
                            href="front-activity-event-detail.html?activityNo=${i.activityNo}"
                            class="event-title"
                            >${i.aname}</a
                          >
                        </div>
                        <div class="event-footer">
                          <div class="event-timing">
                            <h6 class="coupon-status">${sTime}</h6>
                            <span class="publish-time"
                              ><i class="fa-solid fa-clock me-2"></i>${countDays}</span
                            >
                          </div>  
                        </div>
                      </div>
                    </div>`;
                  }
          }
          listTab.innerHTML = str;
        });
        const search=document.querySelector('#search');
         search.addEventListener('input',()=>{
        fetch(`/Activity/ByActName?actName=${search.value}`)
        .then((Response) => Response.json())
        .then((data) => {
          data.reverse();
          let str = "";
          let sTime = "";
          let countDays = "";
          for (i of data) {

            console.log(i.session[0]);
            if (i.astatus == 1) {
              if (i.wetherSeat == 0) {
                sTime = "全站";
                countDays = "售完為止"
              } else {
                sTime = i.session[0].sessionsTime;
                const date = new Date(i.session[0].sessionsTime);
                console.log(dateDiffer(nowDate, date))
                countDays = dateDiffer(now, date);

              }

              str += `<div
                      class="col-xl-3 col-lg-4 col-md-6 col-sm-12 mix arts concert workshops volunteer sports health_Wellness"
                      data-ref="mixitup-target"
                    >
                      <div class="main-card mt-4">
                        <div class="event-thumbnail">
                          <a
                            href="front-activity-event-detail.html?activityNo=${i.activityNo}"
                            class="thumbnail-img"
                          >
                            <img src="data:image/jpeg;base64,${i.aimgt[0].aimg}" alt="" />
                          </a>
                          <span class="bookmark-icon" title="Bookmark"></span>
                        </div>
                        <div class="event-content">
                          <a
                            href="front-activity-event-detail.html?activityNo=${i.activityNo}"
                            class="event-title"
                            >${i.aname}</a
                          >
                        </div>
                        <div class="event-footer">
                          <div class="event-timing">
                            <h6 class="coupon-status">${sTime}</h6>
                            <span class="publish-time"
                              ><i class="fa-solid fa-clock me-2"></i>${countDays}</span
                            >
                          </div>  
                        </div>
                      </div>
                    </div>`;
            }
          }
          listTab.innerHTML = str;
            
        });
        });
        //節目類別 搜尋開始
         fetch(`/Aclass/findAll`)
            .then((Response) => Response.json())
            .then((data) => {
              console.log(data);
              for(i of data){
                console.log("eee")
                $("#aclassList").append(`<button class="control" id="aclass${i.aclassNo}" onclick="findClass(${i.aclassNo})">${i.aclassName}</button>`)
              }
            })


             function findClass (e){
              console.log(e)
              fetch(`/Activity/findByaClassNo?aclassNo=${e}`,{
                method:"POST",
              })
                 .then((Response) => Response.json())
                 .then((data) => {
                  console.log(data)
                  data.reverse();
                   let str = "";
                   let sTime = "";
                   let countDays = "";
                   for (i of data) {

                     console.log(i.session[0]);
                     if (i.astatus == 1) {
                       if (i.wetherSeat == 0) {
                         sTime = "全站";
                         countDays = "售完為止"
                       } else {
                         sTime = i.session[0].sessionsTime;
                         const date = new Date(i.session[0].sessionsTime);
                         console.log(dateDiffer(nowDate, date))
                         countDays = dateDiffer(now, date);

                       }

                       str += `<div
                      class="col-xl-3 col-lg-4 col-md-6 col-sm-12 mix arts concert workshops volunteer sports health_Wellness"
                      data-ref="mixitup-target"
                    >
                      <div class="main-card mt-4">
                        <div class="event-thumbnail">
                          <a
                            href="front-activity-event-detail.html?activityNo=${i.activityNo}"
                            class="thumbnail-img"
                          >
                            <img src="data:image/jpeg;base64,${i.aimgt[0].aimg}" alt="" />
                          </a>
                          <span class="bookmark-icon" title="Bookmark"></span>
                        </div>
                        <div class="event-content">
                          <a
                            href="front-activity-event-detail.html?activityNo=${i.activityNo}"
                            class="event-title"
                            >${i.aname}</a
                          >
                        </div>
                        <div class="event-footer">
                          <div class="event-timing">
                            <h6 class="coupon-status">${sTime}</h6>
                            <span class="publish-time"
                              ><i class="fa-solid fa-clock me-2"></i>${countDays}</span
                            >
                          </div>  
                        </div>
                      </div>
                    </div>`;
                     }
                   }
                   listTab.innerHTML = str;
                 })
             }
             $("#allEventbtn").on("click",()=>{
                 fetch("/Activity/findAll")
                 .then((Response) => Response.json())
                 .then((data) => {
                  data.reverse();
                   let str = "";
                   let sTime = "";
                   let countDays = "";
                   for (i of data) {

                     console.log(i.session[0]);
                     if (i.astatus == 1) {
                       if (i.wetherSeat == 0) {
                         sTime = "全站";
                         countDays = "售完為止"
                       } else {
                         sTime = i.session[0].sessionsTime;
                         const date = new Date(i.session[0].sessionsTime);
                         console.log(dateDiffer(nowDate, date))
                         countDays = dateDiffer(now, date);

                       }

                       str += `<div
                      class="col-xl-3 col-lg-4 col-md-6 col-sm-12 mix arts concert workshops volunteer sports health_Wellness"
                      data-ref="mixitup-target"
                    >
                      <div class="main-card mt-4">
                        <div class="event-thumbnail">
                          <a
                            href="front-activity-event-detail.html?activityNo=${i.activityNo}"
                            class="thumbnail-img"
                          >
                            <img src="data:image/jpeg;base64,${i.aimgt[0].aimg}" alt="" />
                          </a>
                          <span class="bookmark-icon" title="Bookmark"></span>
                        </div>
                        <div class="event-content">
                          <a
                            href="front-activity-event-detail.html?activityNo=${i.activityNo}"
                            class="event-title"
                            >${i.aname}</a
                          >
                        </div>
                        <div class="event-footer">
                          <div class="event-timing">
                            <h6 class="coupon-status">${sTime}</h6>
                            <span class="publish-time"
                              ><i class="fa-solid fa-clock me-2"></i>${countDays}</span
                            >
                          </div>  
                        </div>
                      </div>
                    </div>`;
                     }
                   }
                   listTab.innerHTML = str;
                 });
             })
    </script>
  </body>
</html>
